create or replace procedure stage_pershing.pa_parse_acct(IN _id_proceso bigint)
    language plpgsql
as
$$
DECLARE _cursor_reg_modif refcursor;
DECLARE _reg_modif record;
DECLARE _process_date VARCHAR(100);
begin

    DELETE FROM stage_pershing.stage_acct_reg_header reg_del WHERE reg_del.id_proceso=_id_proceso;
    DELETE FROM stage_pershing.stage_acct_reg_a reg_del WHERE reg_del.id_proceso=_id_proceso;
    DELETE FROM stage_pershing.stage_acct_reg_b reg_del WHERE reg_del.id_proceso=_id_proceso;
    DELETE FROM stage_pershing.stage_acct_reg_c reg_del WHERE reg_del.id_proceso=_id_proceso;
    DELETE FROM stage_pershing.stage_acct_reg_d reg_del WHERE reg_del.id_proceso=_id_proceso;
    DELETE FROM stage_pershing.stage_acct_reg_e reg_del WHERE reg_del.id_proceso=_id_proceso;
    DELETE FROM stage_pershing.stage_acct_reg_f reg_del WHERE reg_del.id_proceso=_id_proceso;
    DELETE FROM stage_pershing.stage_acct_reg_w reg_del WHERE reg_del.id_proceso=_id_proceso;
    DELETE FROM stage_pershing.stage_acct_reg_trailer reg_del WHERE reg_del.id_proceso=_id_proceso;

    INSERT INTO stage_pershing.stage_acct_reg_header (id_proceso, process_date, bof, campo_2, campo_3, date_of_data, campo_5, remote_id, campo_7, run_date, campo_9, run_time, campo_11, refreshed_or_updated, campo_13, eor)
    SELECT fn_reg.id_proceso, fn_reg.process_date, fn_reg.bof, fn_reg.campo_2, fn_reg.campo_3, fn_reg.date_of_data, fn_reg.campo_5, fn_reg.remote_id, fn_reg.campo_7, fn_reg.run_date, fn_reg.campo_9, fn_reg.run_time, fn_reg.campo_11, fn_reg.refreshed_or_updated, fn_reg.campo_13, fn_reg.eor
    FROM stage_pershing.fn_parse_acct_reg_header(_id_proceso) fn_reg;

    INSERT INTO stage_pershing.stage_acct_reg_a (id_proceso, process_date, transaction_code, record_indicator_value, record_id_sequence_number, account_number, ibd_number, campo_6, ip_number, account_short_name, campo_9, transaction_type, autotitled_usertitled_account, account_type_code, registration_type, campo_14, number_of_account_title_lines, account_registration_line_1, account_registration_line_2, account_registration_line_3, account_registration_line_4, account_registration_line_5, account_registration_line_6, registration_type_detail, date_account_opened, date_account_information_updated, account_status_indicator, pending_closed_date, date_account_closed, closing_notice_date, account_reactivated_date, date_account_reopened, proceeds, transfer_instructions, income_isntructions, number_of_confirms_for_thi_account, number_of_statements_for_this_account, investment_objetive_trans_code, comments_act, employer_shotname, employers_cusip, employers_symbol, margin_privileges_revoked, statement_review_date, margin_papers_on_file, option_papers_on_file, campo_45, good_faith_margin, ip_discretion_granted, invest_advisor_discretion_granted, third_party_discretion_granted, third_party_name, risk_factor_code, investment_objetive_code, option_equities, option_index, option_debt, option_currency, option_level_1, option_level_2, option_level_3, option_level_4, option_call_limits, option_put_limits, option_total_limits_of_puts_and_calls, non_us_dollar_trading, campo_65, non_customer_indicator, third_party_fee_indicator, third_party_fee_approval_date, intermediary_account_ind, commission_schedule, group_index, money_manager_id, money_manager_objective_id, dtc_id_confirm_number, caps_master_mnemonic, employee_id, prime_broker_free_fund_indicator, fee_based_account_indicator, campo_79, fee_based_termination_date, campo_81, plan_name, self_directed_401_k_account_type, plan_type, plan_number, employee_or_employee_relative, commission_percent_discount, ind_12_b_1_fee_blocking, name_of_ip_signed_new_account_form, date_of_ip_signed_new_account_form, name_of_principal_signed_new_account_form, date_of_principal_signed_new_account_form, politically_exposed_person, private_banking_account, foreign_bank_account, initial_source_of_funds, usa_patriot_act_exempt_reason, primary_country_of_citizenship, country_of_residence, birth_date, age_based_fund_roll_exempt, money_fundreform_retail, trusted_contact_status, regulatory_account_type_category, account_managed_by_trust_comp_id, voting_auth, campo_107, campo_108, campo_109, campo_110, customer_type, campo_112, campo_113, campo_114, campo_115, campo_116, fulfillment_method, credit_interest_indicator, ama_indicator, campo_120, eor)
    SELECT fn_reg.id_proceso, fn_reg.process_date, fn_reg.transaction_code, fn_reg.record_indicator_value, fn_reg.record_id_sequence_number, fn_reg.account_number, fn_reg.ibd_number, fn_reg.campo_6, fn_reg.ip_number, fn_reg.account_short_name, fn_reg.campo_9, fn_reg.transaction_type, fn_reg.autotitled_usertitled_account, fn_reg.account_type_code, fn_reg.registration_type, fn_reg.campo_14, fn_reg.number_of_account_title_lines, fn_reg.account_registration_line_1, fn_reg.account_registration_line_2, fn_reg.account_registration_line_3, fn_reg.account_registration_line_4, fn_reg.account_registration_line_5, fn_reg.account_registration_line_6, fn_reg.registration_type_detail, fn_reg.date_account_opened, fn_reg.date_account_information_updated, fn_reg.account_status_indicator, fn_reg.pending_closed_date, fn_reg.date_account_closed, fn_reg.closing_notice_date, fn_reg.account_reactivated_date, fn_reg.date_account_reopened, fn_reg.proceeds, fn_reg.transfer_instructions, fn_reg.income_isntructions, fn_reg.number_of_confirms_for_thi_account, fn_reg.number_of_statements_for_this_account, fn_reg.investment_objetive_trans_code, fn_reg.comments_act, fn_reg.employer_shotname, fn_reg.employers_cusip, fn_reg.employers_symbol, fn_reg.margin_privileges_revoked, fn_reg.statement_review_date, fn_reg.margin_papers_on_file, fn_reg.option_papers_on_file, fn_reg.campo_45, fn_reg.good_faith_margin, fn_reg.ip_discretion_granted, fn_reg.invest_advisor_discretion_granted, fn_reg.third_party_discretion_granted, fn_reg.third_party_name, fn_reg.risk_factor_code, fn_reg.investment_objetive_code, fn_reg.option_equities, fn_reg.option_index, fn_reg.option_debt, fn_reg.option_currency, fn_reg.option_level_1, fn_reg.option_level_2, fn_reg.option_level_3, fn_reg.option_level_4, fn_reg.option_call_limits, fn_reg.option_put_limits, fn_reg.option_total_limits_of_puts_and_calls, fn_reg.non_us_dollar_trading, fn_reg.campo_65, fn_reg.non_customer_indicator, fn_reg.third_party_fee_indicator, fn_reg.third_party_fee_approval_date, fn_reg.intermediary_account_ind, fn_reg.commission_schedule, fn_reg.group_index, fn_reg.money_manager_id, fn_reg.money_manager_objective_id, fn_reg.dtc_id_confirm_number, fn_reg.caps_master_mnemonic, fn_reg.employee_id, fn_reg.prime_broker_free_fund_indicator, fn_reg.fee_based_account_indicator, fn_reg.campo_79, fn_reg.fee_based_termination_date, fn_reg.campo_81, fn_reg.plan_name, fn_reg.self_directed_401_k_account_type, fn_reg.plan_type, fn_reg.plan_number, fn_reg.employee_or_employee_relative, fn_reg.commission_percent_discount, fn_reg.ind_12_b_1_fee_blocking, fn_reg.name_of_ip_signed_new_account_form, fn_reg.date_of_ip_signed_new_account_form, fn_reg.name_of_principal_signed_new_account_form, fn_reg.date_of_principal_signed_new_account_form, fn_reg.politically_exposed_person, fn_reg.private_banking_account, fn_reg.foreign_bank_account, fn_reg.initial_source_of_funds, fn_reg.usa_patriot_act_exempt_reason, fn_reg.primary_country_of_citizenship, fn_reg.country_of_residence, fn_reg.birth_date, fn_reg.age_based_fund_roll_exempt, fn_reg.money_fundreform_retail, fn_reg.trusted_contact_status, fn_reg.regulatory_account_type_category, fn_reg.account_managed_by_trust_comp_id, fn_reg.voting_auth, fn_reg.campo_107, fn_reg.campo_108, fn_reg.campo_109, fn_reg.campo_110, fn_reg.customer_type, fn_reg.campo_112, fn_reg.campo_113, fn_reg.campo_114, fn_reg.campo_115, fn_reg.campo_116, fn_reg.fulfillment_method, fn_reg.credit_interest_indicator, fn_reg.ama_indicator, fn_reg.campo_120, fn_reg.eor
    FROM stage_pershing.fn_parse_acct_reg_a(_id_proceso) fn_reg;

    INSERT INTO stage_pershing.stage_acct_reg_b (id_proceso, process_date, transaction_code, record_indicator_value, record_id_sequence_number, account_number, ibd_number, campo_6, ip_number, account_short_name, campo_9, tax_id_type, tax_id_number, date_tax_id_applied_for, w_8_w_9_indicator, w_8_w_9_date_signed, w_8_w_9_effective_date, w_8_w_9_document_type, tax_status, b_notice_reason_code, first_b_notice_status, date_first_b_notice_status_issued_enforced, campo_21, date_first_notice_status_satisfied, second_b_notice_status, date_second_b_notice_status_issued_enforced, campo_25, date_second_b_notice_status_satisfied, c_notice_status, date_c_notice_status_issued_enforced, date_c_notice_status_satisfied, old_account_number, original_account_open_date, unidentified_large_trader_id, campo_33, large_trader_type_code, large_trader_type_last_change_date, campo_36, campo_37, initial_source_of_funds_other, finance_away, account_funding_date, campo_41, statement_currency_code, future_statement_currency_code, future_statement_currency_code_effective_date, account_level_routing_code_1, account_level_routing_code_2, account_level_routing_code_3, account_level_routing_code_4, campo_49, self_directed_ind, digital_advice_ind, pte_account_ind, campo_53, first_ip, second_ip, third_ip, fourth_ip, fifth_ip, sixth_ip, seventh_ip, eighth_ip, ninth_ip, tenth_ip, alert_im_acornym, alert_im_access_code, broker_acronym, cross_reference_indicator, bny_trust_indicator, source_of_asset_at_acct_opening, commission_doscount_code, external_account_number, confirmation_suppression_indicator, date_last_mail_sent, date_last_mail_sent_outside, campo_75, fully_paid_lending_agreement_indicator, fully_paid_lending_agreement_date, custodian_account_type, mifid_customer_categorization, cash_management_tran_code, sweep_status_indicator, date_sweep_activated, date_sweep_details_changed, cober_margin_debit_indicator, campo_85, first_fund_sweep_account_id, firstfund_sweep_account_percent, first_fundsweep_account_redemption_priority, second_fund_sweep_account_id, second_fund_sweep_account_percent, second_fundsweep_account_redemption_priority, type_of_bank_account, banklink_aba_number, banklink_dda_number, campo_95, fund_bank_indicator, campo_97, w_9_corp_tax_classification_code, campo_99, combined_margin_acct_indicator, pledge_collateral_account_indicator, finra_institutional_account_code, proposed_account_reference_id, advisor_model_id, firm_model_style_id, campo_106, campo_107, campo_108, dvp_restriction_code, dvp_restriction_exp_date, escheatment_withholding_ind, campo_112, source_of_origination, source_of_persona, client_onboarding_method, tax_filing_code, campo_117, campo_118, nor_purpose_collateral_acct_ind, eor)
    SELECT fn_reg.id_proceso, fn_reg.process_date, fn_reg.transaction_code, fn_reg.record_indicator_value, fn_reg.record_id_sequence_number, fn_reg.account_number, fn_reg.ibd_number, fn_reg.campo_6, fn_reg.ip_number, fn_reg.account_short_name, fn_reg.campo_9, fn_reg.tax_id_type, fn_reg.tax_id_number, fn_reg.date_tax_id_applied_for, fn_reg.w_8_w_9_indicator, fn_reg.w_8_w_9_date_signed, fn_reg.w_8_w_9_effective_date, fn_reg.w_8_w_9_document_type, fn_reg.tax_status, fn_reg.b_notice_reason_code, fn_reg.first_b_notice_status, fn_reg.date_first_b_notice_status_issued_enforced, fn_reg.campo_21, fn_reg.date_first_notice_status_satisfied, fn_reg.second_b_notice_status, fn_reg.date_second_b_notice_status_issued_enforced, fn_reg.campo_25, fn_reg.date_second_b_notice_status_satisfied, fn_reg.c_notice_status, fn_reg.date_c_notice_status_issued_enforced, fn_reg.date_c_notice_status_satisfied, fn_reg.old_account_number, fn_reg.original_account_open_date, fn_reg.unidentified_large_trader_id, fn_reg.campo_33, fn_reg.large_trader_type_code, fn_reg.large_trader_type_last_change_date, fn_reg.campo_36, fn_reg.campo_37, fn_reg.initial_source_of_funds_other, fn_reg.finance_away, fn_reg.account_funding_date, fn_reg.campo_41, fn_reg.statement_currency_code, fn_reg.future_statement_currency_code, fn_reg.future_statement_currency_code_effective_date, fn_reg.account_level_routing_code_1, fn_reg.account_level_routing_code_2, fn_reg.account_level_routing_code_3, fn_reg.account_level_routing_code_4, fn_reg.campo_49, fn_reg.self_directed_ind, fn_reg.digital_advice_ind, fn_reg.pte_account_ind, fn_reg.campo_53, fn_reg.first_ip, fn_reg.second_ip, fn_reg.third_ip, fn_reg.fourth_ip, fn_reg.fifth_ip, fn_reg.sixth_ip, fn_reg.seventh_ip, fn_reg.eighth_ip, fn_reg.ninth_ip, fn_reg.tenth_ip, fn_reg.alert_im_acornym, fn_reg.alert_im_access_code, fn_reg.broker_acronym, fn_reg.cross_reference_indicator, fn_reg.bny_trust_indicator, fn_reg.source_of_asset_at_acct_opening, fn_reg.commission_doscount_code, fn_reg.external_account_number, fn_reg.confirmation_suppression_indicator, fn_reg.date_last_mail_sent, fn_reg.date_last_mail_sent_outside, fn_reg.campo_75, fn_reg.fully_paid_lending_agreement_indicator, fn_reg.fully_paid_lending_agreement_date, fn_reg.custodian_account_type, fn_reg.mifid_customer_categorization, fn_reg.cash_management_tran_code, fn_reg.sweep_status_indicator, fn_reg.date_sweep_activated, fn_reg.date_sweep_details_changed, fn_reg.cober_margin_debit_indicator, fn_reg.campo_85, fn_reg.first_fund_sweep_account_id, fn_reg.firstfund_sweep_account_percent, fn_reg.first_fundsweep_account_redemption_priority, fn_reg.second_fund_sweep_account_id, fn_reg.second_fund_sweep_account_percent, fn_reg.second_fundsweep_account_redemption_priority, fn_reg.type_of_bank_account, fn_reg.banklink_aba_number, fn_reg.banklink_dda_number, fn_reg.campo_95, fn_reg.fund_bank_indicator, fn_reg.campo_97, fn_reg.w_9_corp_tax_classification_code, fn_reg.campo_99, fn_reg.combined_margin_acct_indicator, fn_reg.pledge_collateral_account_indicator, fn_reg.finra_institutional_account_code, fn_reg.proposed_account_reference_id, fn_reg.advisor_model_id, fn_reg.firm_model_style_id, fn_reg.campo_106, fn_reg.campo_107, fn_reg.campo_108, fn_reg.dvp_restriction_code, fn_reg.dvp_restriction_exp_date, fn_reg.escheatment_withholding_ind, fn_reg.campo_112, fn_reg.source_of_origination, fn_reg.source_of_persona, fn_reg.client_onboarding_method, fn_reg.tax_filing_code, fn_reg.campo_117, fn_reg.campo_118, fn_reg.nor_purpose_collateral_acct_ind, fn_reg.eor
    FROM stage_pershing.fn_parse_acct_reg_b(_id_proceso) fn_reg;

    INSERT INTO stage_pershing.stage_acct_reg_c (id_proceso, process_date, transaction_code, record_indicator_value, record_id_sequence_number, account_number, ibd_number, campo_6, ip_number, account_short_name, campo_9, addr_1_trx_code, addr_1_special_handling_ind, addr_1_delivery_id, addr_1_attention_line_prefix, addr_1_attention_line_detail, addr_1_line_1, addr_1_line_2, addr_1_line_3, addr_1_line_4, addr_1_city_state, addr_1_country_code, campo_21, campo_22, campo_23, campo_24, campo_25, campo_26, campo_27, campo_28, campo_29, campo_30, addr_2_trx_code, addr_2_special_handling_ind, addr_2_delivery_id, addr_2_attention_line_prefix, addr_2_attention_line_detail, addr_2_line_1, addr_2_line_2, addr_2_line_3, addr_2_line_4, addr_2_city_state, addr_2_country_code, account_description, set_as_mail_addr_2_ind, campo_44, principal_billing_allocation_pct, campo_46, seasonal_addr_id_1, from_date_1, to_date_1, seasonal_addr_id_2, from_date_2, to_date_2, seasonal_addr_id_3, from_date_3, to_date_3, cost_basis_acct_system, disposition_method_mutual_funds, disposition_method_other, disposition_method_stocks, campo_60, amortize_taxable_premium_bonds, accrue_market_disc_based_on, accrue_market_disc_income, campo_64, campo_65, campo_66, eor)
    SELECT fn_reg.id_proceso, fn_reg.process_date, fn_reg.transaction_code, fn_reg.record_indicator_value, fn_reg.record_id_sequence_number, fn_reg.account_number, fn_reg.ibd_number, fn_reg.campo_6, fn_reg.ip_number, fn_reg.account_short_name, fn_reg.campo_9, fn_reg.addr_1_trx_code, fn_reg.addr_1_special_handling_ind, fn_reg.addr_1_delivery_id, fn_reg.addr_1_attention_line_prefix, fn_reg.addr_1_attention_line_detail, fn_reg.addr_1_line_1, fn_reg.addr_1_line_2, fn_reg.addr_1_line_3, fn_reg.addr_1_line_4, fn_reg.addr_1_city_state, fn_reg.addr_1_country_code, fn_reg.campo_21, fn_reg.campo_22, fn_reg.campo_23, fn_reg.campo_24, fn_reg.campo_25, fn_reg.campo_26, fn_reg.campo_27, fn_reg.campo_28, fn_reg.campo_29, fn_reg.campo_30, fn_reg.addr_2_trx_code, fn_reg.addr_2_special_handling_ind, fn_reg.addr_2_delivery_id, fn_reg.addr_2_attention_line_prefix, fn_reg.addr_2_attention_line_detail, fn_reg.addr_2_line_1, fn_reg.addr_2_line_2, fn_reg.addr_2_line_3, fn_reg.addr_2_line_4, fn_reg.addr_2_city_state, fn_reg.addr_2_country_code, fn_reg.account_description, fn_reg.set_as_mail_addr_2_ind, fn_reg.campo_44, fn_reg.principal_billing_allocation_pct, fn_reg.campo_46, fn_reg.seasonal_addr_id_1, fn_reg.from_date_1, fn_reg.to_date_1, fn_reg.seasonal_addr_id_2, fn_reg.from_date_2, fn_reg.to_date_2, fn_reg.seasonal_addr_id_3, fn_reg.from_date_3, fn_reg.to_date_3, fn_reg.cost_basis_acct_system, fn_reg.disposition_method_mutual_funds, fn_reg.disposition_method_other, fn_reg.disposition_method_stocks, fn_reg.campo_60, fn_reg.amortize_taxable_premium_bonds, fn_reg.accrue_market_disc_based_on, fn_reg.accrue_market_disc_income, fn_reg.campo_64, fn_reg.campo_65, fn_reg.campo_66, fn_reg.eor
    FROM stage_pershing.fn_parse_acct_reg_c(_id_proceso) fn_reg;

    INSERT INTO stage_pershing.stage_acct_reg_d (id_proceso, process_date, transaction_code, record_indicator_value, record_id_sequence_number, account_number, ibd_number, campo_6, ip_number, account_short_name, campo_9, addr_3_trx_code, addr_3_special_handling_ind, addr_3_delivery_id, addr_3_attention_line_prefix, addr_3_attention_line_detail, addr_3_line_1, addr_3_line_2, addr_3_line_3, addr_3_line_4, addr_3_city_state, addr_3_country_code, set_as_mail_addr_3_ind, campo_22, addr_4_trx_code, addr_4_special_handling_ind, addr_4_delivery_id, addr_4_attention_line_prefix, addr_4_attention_line_detail, addr_4_line_1, addr_4_line_2, addr_4_line_3, addr_4_line_4, addr_4_city_state, addr_4_country_code, set_as_mail_addr_4_ind, campo_35, eor)
    SELECT fn_reg.id_proceso, fn_reg.process_date, fn_reg.transaction_code, fn_reg.record_indicator_value, fn_reg.record_id_sequence_number, fn_reg.account_number, fn_reg.ibd_number, fn_reg.campo_6, fn_reg.ip_number, fn_reg.account_short_name, fn_reg.campo_9, fn_reg.addr_3_trx_code, fn_reg.addr_3_special_handling_ind, fn_reg.addr_3_delivery_id, fn_reg.addr_3_attention_line_prefix, fn_reg.addr_3_attention_line_detail, fn_reg.addr_3_line_1, fn_reg.addr_3_line_2, fn_reg.addr_3_line_3, fn_reg.addr_3_line_4, fn_reg.addr_3_city_state, fn_reg.addr_3_country_code, fn_reg.set_as_mail_addr_3_ind, fn_reg.campo_22, fn_reg.addr_4_trx_code, fn_reg.addr_4_special_handling_ind, fn_reg.addr_4_delivery_id, fn_reg.addr_4_attention_line_prefix, fn_reg.addr_4_attention_line_detail, fn_reg.addr_4_line_1, fn_reg.addr_4_line_2, fn_reg.addr_4_line_3, fn_reg.addr_4_line_4, fn_reg.addr_4_city_state, fn_reg.addr_4_country_code, fn_reg.set_as_mail_addr_4_ind, fn_reg.campo_35, fn_reg.eor
    FROM stage_pershing.fn_parse_acct_reg_d(_id_proceso) fn_reg;

    INSERT INTO stage_pershing.stage_acct_reg_e (id_proceso, process_date, transaction_code, record_indicator_value, record_id_sequence_number, account_number, ibd_number, campo_6, ip_number, account_short_name, campo_9, addr_5_trx_code, addr_5_special_handling_ind, addr_5_delivery_id, addr_5_attention_line_prefix, addr_5_attention_line_detail, addr_5_line_1, addr_5_line_2, addr_5_line_3, addr_5_line_4, addr_5_city_state, addr_5_country_code, set_as_mail_addr_5_ind, campo_22, addr_6_trx_code, addr_6_special_handling_ind, addr_6_delivery_id, addr_6_attention_line_prefix, addr_6_attention_line_detail, addr_6_line_1, addr_6_line_2, addr_6_line_3, addr_6_line_4, addr_6_city_state, addr_6_country_code, set_as_mail_addr_6_ind, campo_35, eor)
    SELECT fn_reg.id_proceso, fn_reg.process_date, fn_reg.transaction_code, fn_reg.record_indicator_value, fn_reg.record_id_sequence_number, fn_reg.account_number, fn_reg.ibd_number, fn_reg.campo_6, fn_reg.ip_number, fn_reg.account_short_name, fn_reg.campo_9, fn_reg.addr_5_trx_code, fn_reg.addr_5_special_handling_ind, fn_reg.addr_5_delivery_id, fn_reg.addr_5_attention_line_prefix, fn_reg.addr_5_attention_line_detail, fn_reg.addr_5_line_1, fn_reg.addr_5_line_2, fn_reg.addr_5_line_3, fn_reg.addr_5_line_4, fn_reg.addr_5_city_state, fn_reg.addr_5_country_code, fn_reg.set_as_mail_addr_5_ind, fn_reg.campo_22, fn_reg.addr_6_trx_code, fn_reg.addr_6_special_handling_ind, fn_reg.addr_6_delivery_id, fn_reg.addr_6_attention_line_prefix, fn_reg.addr_6_attention_line_detail, fn_reg.addr_6_line_1, fn_reg.addr_6_line_2, fn_reg.addr_6_line_3, fn_reg.addr_6_line_4, fn_reg.addr_6_city_state, fn_reg.addr_6_country_code, fn_reg.set_as_mail_addr_6_ind, fn_reg.campo_35, fn_reg.eor
    FROM stage_pershing.fn_parse_acct_reg_e(_id_proceso) fn_reg;

    INSERT INTO stage_pershing.stage_acct_reg_f (id_proceso, process_date, transaction_code, record_indicator_value, record_id_sequence_number, account_number, ibd_number, campo_6, ip_number, account_short_name, campo_9, addr_7_trx_code, addr_7_special_handling_ind, addr_7_delivery_id, addr_7_attention_line_prefix, addr_7_attention_line_detail, addr_7_line_1, addr_7_line_2, addr_7_line_3, addr_7_line_4, addr_7_city_state, addr_7_country_code, set_as_mail_addr_7_ind, campo_22, eor)
    SELECT fn_reg.id_proceso, fn_reg.process_date, fn_reg.transaction_code, fn_reg.record_indicator_value, fn_reg.record_id_sequence_number, fn_reg.account_number, fn_reg.ibd_number, fn_reg.campo_6, fn_reg.ip_number, fn_reg.account_short_name, fn_reg.campo_9, fn_reg.addr_7_trx_code, fn_reg.addr_7_special_handling_ind, fn_reg.addr_7_delivery_id, fn_reg.addr_7_attention_line_prefix, fn_reg.addr_7_attention_line_detail, fn_reg.addr_7_line_1, fn_reg.addr_7_line_2, fn_reg.addr_7_line_3, fn_reg.addr_7_line_4, fn_reg.addr_7_city_state, fn_reg.addr_7_country_code, fn_reg.set_as_mail_addr_7_ind, fn_reg.campo_22, fn_reg.eor
    FROM stage_pershing.fn_parse_acct_reg_f(_id_proceso) fn_reg;

    INSERT INTO stage_pershing.stage_acct_reg_w (id_proceso, process_date, transaction_code, record_indicator_value, record_id_sequence_number, account_number, ibd_number, campo_6, ip_number, account_short_name, campo_9, record_transaction_code, non_us_dollar_trading, base_currency, income_currency, statement_language, statement_format_code, msrb_statement_ind, campo_17, pep, first_name_pep, last_name_pep, suffix_pep, political_office_held, country_of_office, foreign_bank_account_ind, foreign_bank_cert_date, foreign_bank_cert_exp_date, central_bank_ind, acct_foreign_financial_inst, foreign_bank_acct_oper_1, foreign_bank_acct_oper_2, foreign_bank_acct_oper_3, number_people_own, proprietary_acct_owned, campo_34, tel_1_transaction_code, tel_1_us_ind, tel_1_type_id, tel_1_number, tel_1_extension, tel_2_transaction_code, tel_2_us_ind, tel_2_type_id, tel_2_number, tel_2_extension, tel_3_transaction_code, tel_3_us_ind, tel_3_type_id, tel_3_number, tel_3_extension, tel_4_transaction_code, tel_4_us_ind, tel_4_type_id, tel_4_number, tel_4_extension, tel_5_transaction_code, tel_5_us_ind, tel_5_type_id, tel_5_number, tel_5_extension, tel_6_transaction_code, tel_6_us_ind, tel_6_type_id, tel_6_number, tel_6_extension, tel_7_transaction_code, tel_7_us_ind, tel_7_type_id, tel_7_number, tel_7_extension, tel_8_transaction_code, tel_8_us_ind, tel_8_type_id, tel_8_number, tel_8_extension, email_address, external_position_ind, purge_eligible_ind, advisory_acct_ind, product_profile_code, cents_per_share_discount, campo_81, option_disclosure_date, campo_83, country_acct_level_tax_residency, eor)
    SELECT fn_reg.id_proceso, fn_reg.process_date, fn_reg.transaction_code, fn_reg.record_indicator_value, fn_reg.record_id_sequence_number, fn_reg.account_number, fn_reg.ibd_number, fn_reg.campo_6, fn_reg.ip_number, fn_reg.account_short_name, fn_reg.campo_9, fn_reg.record_transaction_code, fn_reg.non_us_dollar_trading, fn_reg.base_currency, fn_reg.income_currency, fn_reg.statement_language, fn_reg.statement_format_code, fn_reg.msrb_statement_ind, fn_reg.campo_17, fn_reg.pep, fn_reg.first_name_pep, fn_reg.last_name_pep, fn_reg.suffix_pep, fn_reg.political_office_held, fn_reg.country_of_office, fn_reg.foreign_bank_account_ind, fn_reg.foreign_bank_cert_date, fn_reg.foreign_bank_cert_exp_date, fn_reg.central_bank_ind, fn_reg.acct_foreign_financial_inst, fn_reg.foreign_bank_acct_oper_1, fn_reg.foreign_bank_acct_oper_2, fn_reg.foreign_bank_acct_oper_3, fn_reg.number_people_own, fn_reg.proprietary_acct_owned, fn_reg.campo_34, fn_reg.tel_1_transaction_code, fn_reg.tel_1_us_ind, fn_reg.tel_1_type_id, fn_reg.tel_1_number, fn_reg.tel_1_extension, fn_reg.tel_2_transaction_code, fn_reg.tel_2_us_ind, fn_reg.tel_2_type_id, fn_reg.tel_2_number, fn_reg.tel_2_extension, fn_reg.tel_3_transaction_code, fn_reg.tel_3_us_ind, fn_reg.tel_3_type_id, fn_reg.tel_3_number, fn_reg.tel_3_extension, fn_reg.tel_4_transaction_code, fn_reg.tel_4_us_ind, fn_reg.tel_4_type_id, fn_reg.tel_4_number, fn_reg.tel_4_extension, fn_reg.tel_5_transaction_code, fn_reg.tel_5_us_ind, fn_reg.tel_5_type_id, fn_reg.tel_5_number, fn_reg.tel_5_extension, fn_reg.tel_6_transaction_code, fn_reg.tel_6_us_ind, fn_reg.tel_6_type_id, fn_reg.tel_6_number, fn_reg.tel_6_extension, fn_reg.tel_7_transaction_code, fn_reg.tel_7_us_ind, fn_reg.tel_7_type_id, fn_reg.tel_7_number, fn_reg.tel_7_extension, fn_reg.tel_8_transaction_code, fn_reg.tel_8_us_ind, fn_reg.tel_8_type_id, fn_reg.tel_8_number, fn_reg.tel_8_extension, fn_reg.email_address, fn_reg.external_position_ind, fn_reg.purge_eligible_ind, fn_reg.advisory_acct_ind, fn_reg.product_profile_code, fn_reg.cents_per_share_discount, fn_reg.campo_81, fn_reg.option_disclosure_date, fn_reg.campo_83, fn_reg.country_acct_level_tax_residency, fn_reg.eor
    FROM stage_pershing.fn_parse_acct_reg_w(_id_proceso) fn_reg;

    INSERT INTO stage_pershing.stage_acct_reg_trailer (id_proceso, process_date, eof, campo_02, campo_03, date_of_data, campo_05, remote_id, campo_07, campo_08, number_of_detail_records, campo_10, refreshed_or_updated, campo_12, eor)
    SELECT fn_reg.id_proceso, fn_reg.process_date, fn_reg.eof, fn_reg.campo_02, fn_reg.campo_03, fn_reg.date_of_data, fn_reg.campo_05, fn_reg.remote_id, fn_reg.campo_07, fn_reg.campo_08, fn_reg.number_of_detail_records, fn_reg.campo_10, fn_reg.refreshed_or_updated, fn_reg.campo_12, fn_reg.eor
    FROM stage_pershing.fn_parse_acct_reg_trailer(_id_proceso) fn_reg;

end;
$$;

alter procedure stage_pershing.pa_parse_acct(bigint) owner to postgres;

